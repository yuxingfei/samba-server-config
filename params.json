{
  "name": "Samba-server-config",
  "tagline": "windows访问samba共享文件夹",
  "body": "# samba-server-config\r\nwindows访问samba共享文件夹\r\n\r\n网上有很多关于此问题的说明，但五花八门，很多人都没配置成功，我试了几个也不成功，研究了下重新整理了个亲测可使用的配置说明\r\n技术交流QQ群242722019\r\n\r\n1、关闭防火墙iptables和SELinux\r\n2、安装samba服务yum -y install samba\r\n3、useradd smb //首先创建一个测试账号用于登录samba验证用户\r\n4、chown -R smb:smb chatroom/  //这里举例我要把chatroom文件夹作为共享文件夹,更改当前文件夹及里面文件的所属组为smb所有\r\n5、开始进行smb.conf配置文件的设置\r\n6、smbpasswd smb //为smb账号设置独立的smbpasswd\r\n7、启动 service smb start\r\n\r\n附上\r\nsmb.conf配置文件\r\n\r\n# This is the main Samba configuration file. You should read the\r\n# smb.conf(5) manual page in order to understand the options listed\r\n# here. Samba has a huge number of configurable options (perhaps too\r\n# many!) most of which are not shown in this example\r\n#\r\n# For a step to step guide on installing, configuring and using samba, \r\n# read the Samba-HOWTO-Collection. This may be obtained from:\r\n#  http://www.samba.org/samba/docs/Samba-HOWTO-Collection.pdf\r\n#\r\n# Many working examples of smb.conf files can be found in the \r\n# Samba-Guide which is generated daily and can be downloaded from: \r\n#  http://www.samba.org/samba/docs/Samba-Guide.pdf\r\n#\r\n# Any line which starts with a ; (semi-colon) or a # (hash) \r\n# is a comment and is ignored. In this example we will use a #\r\n# for commentry and a ; for parts of the config file that you\r\n# may wish to enable\r\n#\r\n# NOTE: Whenever you modify this file you should run the command \"testparm\"\r\n# to check that you have not made any basic syntactic errors. \r\n#\r\n#---------------\r\n# SELINUX NOTES:\r\n#\r\n# If you want to use the useradd/groupadd family of binaries please run:\r\n# setsebool -P samba_domain_controller on\r\n#\r\n# If you want to share home directories via samba please run:\r\n# setsebool -P samba_enable_home_dirs on\r\n#\r\n# If you create a new directory you want to share you should mark it as\r\n# \"samba_share_t\" so that selinux will let you write into it.\r\n# Make sure not to do that on system directories as they may already have\r\n# been marked with othe SELinux labels.\r\n#\r\n# Use ls -ldZ /path to see which context a directory has\r\n#\r\n# Set labels only on directories you created!\r\n# To set a label use the following: chcon -t samba_share_t /path\r\n#\r\n# If you need to share a system created directory you can use one of the\r\n# following (read-only/read-write):\r\n# setsebool -P samba_export_all_ro on\r\n# or\r\n# setsebool -P samba_export_all_rw on\r\n#\r\n# If you want to run scripts (preexec/root prexec/print command/...) please\r\n# put them into the /var/lib/samba/scripts directory so that smbd will be\r\n# allowed to run them.\r\n# Make sure you COPY them and not MOVE them so that the right SELinux context\r\n# is applied, to check all is ok use restorecon -R -v /var/lib/samba/scripts\r\n#\r\n#--------------\r\n#\r\n#======================= Global Settings =====================================\r\n\t\r\n[global]\r\n\t\r\n# ----------------------- Network Related Options -------------------------\r\n#\r\n# workgroup = NT-Domain-Name or Workgroup-Name, eg: MIDEARTH\r\n#\r\n# server string is the equivalent of the NT Description field\r\n#\r\n# netbios name can be used to specify a server name not tied to the hostname\r\n#\r\n# Interfaces lets you configure Samba to use multiple interfaces\r\n# If you have multiple network interfaces then you can list the ones\r\n# you want to listen on (never omit localhost)\r\n#\r\n# Hosts Allow/Hosts Deny lets you restrict who can connect, and you can\r\n# specifiy it as a per share option as well\r\n#\r\n\tworkgroup = MYGROUP\r\n\tserver string = Samba Server Version %v\r\n\t\r\n;\tnetbios name = MYSERVER\r\n\t\r\n;\tinterfaces = lo eth0 192.168.12.2/24 192.168.13.2/24 \r\n;\thosts allow = 127. 192.168.12. 192.168.13.\r\n\t\r\n# --------------------------- Logging Options -----------------------------\r\n#\r\n# Log File let you specify where to put logs and how to split them up.\r\n#\r\n# Max Log Size let you specify the max size log files should reach\r\n\t\r\n\t# logs split per machine\r\n\tlog file = /var/log/samba/log.%m\r\n\t# max 50KB per log file, then rotate\r\n\tmax log size = 50\r\n\t\r\n# ----------------------- Standalone Server Options ------------------------\r\n#\r\n# Scurity can be set to user, share(deprecated) or server(deprecated)\r\n#\r\n# Backend to store user information in. New installations should \r\n# use either tdbsam or ldapsam. smbpasswd is available for backwards \r\n# compatibility. tdbsam requires no further configuration.\r\n\r\n\tsecurity = user #上面描述的很清楚，user表示samba验证访问\r\n\tpassdb backend = tdbsam\r\n\r\n\r\n# ----------------------- Domain Members Options ------------------------\r\n#\r\n# Security must be set to domain or ads\r\n#\r\n# Use the realm option only with security = ads\r\n# Specifies the Active Directory realm the host is part of\r\n#\r\n# Backend to store user information in. New installations should \r\n# use either tdbsam or ldapsam. smbpasswd is available for backwards \r\n# compatibility. tdbsam requires no further configuration.\r\n#\r\n# Use password server option only with security = server or if you can't\r\n# use the DNS to locate Domain Controllers\r\n# The argument list may include:\r\n#   password server = My_PDC_Name [My_BDC_Name] [My_Next_BDC_Name]\r\n# or to auto-locate the domain controller/s\r\n#   password server = *\r\n\t\r\n\t\r\n;\tsecurity = domain\r\n;\tpassdb backend = tdbsam\r\n;\trealm = MY_REALM\r\n\r\n;\tpassword server = <NT-Server-Name>\r\n\r\n# ----------------------- Domain Controller Options ------------------------\r\n#\r\n# Security must be set to user for domain controllers\r\n#\r\n# Backend to store user information in. New installations should \r\n# use either tdbsam or ldapsam. smbpasswd is available for backwards \r\n# compatibility. tdbsam requires no further configuration.\r\n#\r\n# Domain Master specifies Samba to be the Domain Master Browser. This\r\n# allows Samba to collate browse lists between subnets. Don't use this\r\n# if you already have a Windows NT domain controller doing this job\r\n#\r\n# Domain Logons let Samba be a domain logon server for Windows workstations. \r\n#\r\n# Logon Scrpit let yuou specify a script to be run at login time on the client\r\n# You need to provide it in a share called NETLOGON\r\n#\r\n# Logon Path let you specify where user profiles are stored (UNC path)\r\n#\r\n# Various scripts can be used on a domain controller or stand-alone\r\n# machine to add or delete corresponding unix accounts\r\n#\r\n;\tsecurity = user\r\n;\tpassdb backend = tdbsam\r\n\t\r\n;\tdomain master = yes \r\n;\tdomain logons = yes\r\n\t\r\n\t# the login script name depends on the machine name\r\n;\tlogon script = %m.bat\r\n\t# the login script name depends on the unix user used\r\n;\tlogon script = %u.bat\r\n;\tlogon path = \\\\%L\\Profiles\\%u\r\n\t# disables profiles support by specifing an empty path\r\n;\tlogon path =          \r\n\t\r\n;\tadd user script = /usr/sbin/useradd \"%u\" -n -g users\r\n;\tadd group script = /usr/sbin/groupadd \"%g\"\r\n;\tadd machine script = /usr/sbin/useradd -n -c \"Workstation (%u)\" -M -d /nohome -s /bin/false \"%u\"\r\n;\tdelete user script = /usr/sbin/userdel \"%u\"\r\n;\tdelete user from group script = /usr/sbin/userdel \"%u\" \"%g\"\r\n;\tdelete group script = /usr/sbin/groupdel \"%g\"\r\n\t\r\n\t\r\n# ----------------------- Browser Control Options ----------------------------\r\n#\r\n# set local master to no if you don't want Samba to become a master\r\n# browser on your network. Otherwise the normal election rules apply\r\n#\r\n# OS Level determines the precedence of this server in master browser\r\n# elections. The default value should be reasonable\r\n#\r\n# Preferred Master causes Samba to force a local browser election on startup\r\n# and gives it a slightly higher chance of winning the election\r\n;\tlocal master = no\r\n;\tos level = 33\r\n;\tpreferred master = yes\r\n\t\r\n#----------------------------- Name Resolution -------------------------------\r\n# Windows Internet Name Serving Support Section:\r\n# Note: Samba can be either a WINS Server, or a WINS Client, but NOT both\r\n#\r\n# - WINS Support: Tells the NMBD component of Samba to enable it's WINS Server\r\n#\r\n# - WINS Server: Tells the NMBD components of Samba to be a WINS Client\r\n#\r\n# - WINS Proxy: Tells Samba to answer name resolution queries on\r\n#   behalf of a non WINS capable client, for this to work there must be\r\n#   at least one\tWINS Server on the network. The default is NO.\r\n#\r\n# DNS Proxy - tells Samba whether or not to try to resolve NetBIOS names\r\n# via DNS nslookups.\r\n\t\r\n;\twins support = yes\r\n;\twins server = w.x.y.z\r\n;\twins proxy = yes\r\n\t\r\n;\tdns proxy = yes\r\n\t\r\n# --------------------------- Printing Options -----------------------------\r\n#\r\n# Load Printers let you load automatically the list of printers rather\r\n# than setting them up individually\r\n#\r\n# Cups Options let you pass the cups libs custom options, setting it to raw\r\n# for example will let you use drivers on your Windows clients\r\n#\r\n# Printcap Name let you specify an alternative printcap file\r\n#\r\n# You can choose a non default printing system using the Printing option\r\n\t\r\n\tload printers = yes\r\n\tcups options = raw\r\n\r\n;\tprintcap name = /etc/printcap\r\n\t#obtain list of printers automatically on SystemV\r\n;\tprintcap name = lpstat\r\n;\tprinting = cups\r\n\r\n# --------------------------- Filesystem Options ---------------------------\r\n#\r\n# The following options can be uncommented if the filesystem supports\r\n# Extended Attributes and they are enabled (usually by the mount option\r\n# user_xattr). Thess options will let the admin store the DOS attributes\r\n# in an EA and make samba not mess with the permission bits.\r\n#\r\n# Note: these options can also be set just per share, setting them in global\r\n# makes them the default for all shares\r\n\r\n;\tmap archive = no\r\n;\tmap hidden = no\r\n;\tmap read only = no\r\n;\tmap system = no\r\n;\tstore dos attributes = yes\r\n\r\n\r\n#============================ Share Definitions ==============================\r\n\t\r\n[homes]\r\n\tcomment = Home Directories\r\n\tbrowseable = no\r\n\twritable = yes\r\n;\tvalid users = %S\r\n;\tvalid users = MYDOMAIN\\%S\r\n\t\r\n[printers]\r\n\tcomment = All Printers\r\n\tpath = /var/spool/samba\r\n\tbrowseable = no\r\n\tguest ok = no\r\n\twritable = no\r\n\tprintable = yes\r\n\t\r\n# Un-comment the following and create the netlogon directory for Domain Logons\r\n;\t[netlogon]\r\n;\tcomment = Network Logon Service\r\n;\tpath = /var/lib/samba/netlogon\r\n;\tguest ok = yes\r\n;\twritable = no\r\n;\tshare modes = no\r\n\t\r\n\t\r\n# Un-comment the following to provide a specific roving profile share\r\n# the default is to use the user's home directory\r\n;\t[Profiles]\r\n;\tpath = /var/lib/samba/profiles\r\n;\tbrowseable = no\r\n;\tguest ok = yes\r\n#共享文件夹\r\n\t[chatroom] #显示的共享名称\r\n\tcomment = testing #注释描述\r\n\tpath = /usr/local/apache2/htdocs/Swoole/chatroom #分享文件夹路径\r\n\tbrowseable = yes #是否可浏览\r\n\twritable = yes\t#一定要设置 设置create mask 和 directory mask的前提条件\r\n\tcreate mask = 0755 #这个一定要设置,否则不可写入\r\n\tdirectory mask = 0755 #这个一定要设置同上\r\n\tpublic = no  #是否无需验证访问\r\n\twrite list = @smb\t#允许写入的组，或用户名多个用空格或逗号隔开\r\n\tvalid users = @smb  #允许访问的用户 用空格或逗号隔开\r\n# A publicly accessible directory, but read only, except for people in\r\n# the \"staff\" group\r\n;\t[public]\r\n;\tcomment = Public Stuff\r\n;\tpath = /home/samba\r\n;\tpublic = yes\r\n;\twritable = yes\r\n;\tprintable = no\r\n;\twrite list = +staff\r\n\r\n\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}